services:
  lendsqr_test:
      image: ${LENDSQR_BACKEND_IMAGE}
      container_name: lendsqr-test
      ports:
        - 8001:8001
      environment:
        DB_USER: ${DB_USER}
        PASSWORD: ${PASSWORD}
        CLUSTERNAME: ${CLUSTERNAME}
      depends_on:
        - redis-test
      command: ["pytest"]

  redis-test:
    image: redis
    container_name: redis-test
    ports:
      - 6380:6380
    volumes:
      - ./redis.conf:/usr/local/etc/redis/redis.conf
    command: ["redis-server", "/usr/local/etc/redis/redis.conf"]